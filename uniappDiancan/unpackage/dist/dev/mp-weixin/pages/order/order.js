(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/order"],{185:function(e,t,n){"use strict";(function(e,t){var o=n(4);n(26);o(n(25));var r=o(n(186));e.__webpack_require_UNI_MP_PLUGIN__=n,t(r.default)}).call(this,n(1)["default"],n(2)["createPage"])},186:function(e,t,n){"use strict";n.r(t);var o=n(187),r=n(189);for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n(193),n(195);var a,s=n(42),c=Object(s["default"])(r["default"],o["render"],o["staticRenderFns"],!1,null,"127632e4",null,!1,o["components"],a);c.options.__file="pages/order/order.vue",t["default"]=c.exports},187:function(e,t,n){"use strict";n.r(t);var o=n(188);n.d(t,"render",(function(){return o["render"]})),n.d(t,"staticRenderFns",(function(){return o["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return o["recyclableRender"]})),n.d(t,"components",(function(){return o["components"]}))},188:function(e,t,n){"use strict";var o;n.r(t),n.d(t,"render",(function(){return r})),n.d(t,"staticRenderFns",(function(){return a})),n.d(t,"recyclableRender",(function(){return i})),n.d(t,"components",(function(){return o}));try{o={uSearch:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-search/u-search")]).then(n.bind(null,773))},uIcon:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-icon/u-icon")]).then(n.bind(null,752))},uNoticeBar:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-notice-bar/u-notice-bar")]).then(n.bind(null,781))},orderlist:function(){return n.e("components/orderlist/orderlist").then(n.bind(null,789))},uEmpty:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-empty/u-empty")]).then(n.bind(null,796))},ordercard:function(){return n.e("components/ordercard/ordercard").then(n.bind(null,804))},height:function(){return n.e("components/height/height").then(n.bind(null,768))},uPopup:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-popup/u-popup")]).then(n.bind(null,811))},close:function(){return n.e("components/close/close").then(n.bind(null,819))},specification:function(){return n.e("components/specification/specification").then(n.bind(null,826))},login:function(){return Promise.all([n.e("common/vendor"),n.e("components/login/login")]).then(n.bind(null,761))}}}catch(s){if(-1===s.message.indexOf("Cannot find module")||-1===s.message.indexOf(".vue"))throw s;console.error(s.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var r=function(){var e=this,t=e.$createElement,n=(e._self._c,e.countKM(e.store_default_data.distance)||0),o=e.__map(e.store_infoApi_data,(function(t,n){var o=e.__get_orig(t),r=t.goods.length;return{$orig:o,g0:r}}));e._isMounted||(e.e0=function(t){e.enter=!0},e.e1=function(t){e.show_specification=!1},e.e2=function(t){e.enter=!0},e.e3=function(t){e.counp_show=!1}),e.$mp.data=Object.assign({},{$root:{m0:n,l0:o}})},i=!1,a=[];r._withStripped=!0},189:function(e,t,n){"use strict";n.r(t);var o=n(190),r=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=r.a},190:function(e,t,n){"use strict";(function(e){var o=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(30)),i=o(n(18)),a=o(n(32)),s=n(33),c=(n(191),o(n(35))),u=o(n(38)),d=n(180),l=(n(36),n(192)),f=n(39),p=(n(47),function(){n.e("components/xm-bezier-cart/xm-bezier-cart").then(function(){return resolve(n(833))}.bind(null,n)).catch(n.oe)}),h={data:function(){return{rightId:"",topList:[],leftId:"",notice:["通知1","通知2"],Httpimg:c.default.HttpImg,search:"",addshow:!0,popshow:!1,activate_data:2,show_specification:!1,counp_show:!0,list1:"",list1url:"",childindex:0,store_default_data:{},store_infoApi_data:[],orderlist:[],store_id:"",specification_list:[],order_id:"",order_type:null,style:[],orderprive:0,shopping_trolley_list:{},display:!1,enter:!1,System_height:(0,l.cellphone)(),components_index:0,components_indexb:0,scene:null,seatShow:!0,peopleCur:0,peopleCount:1,people:"",addAdish:!1,option:null,content:[],contentarr:[],dine_msg:{number:"",count:0}}},components:{XmBezierCart:p},onLoad:function(t){if(t.scene){var n=e.getStorageSync("option");3!==n&&(0,d.order_empty)();var o=t.scene.split("_"),r=o[1];this.dine_msg.number=o[0],"1"==r||1==r?e.setStorageSync("firstPay",1):e.setStorageSync("firstPay",2),e.setStorageSync("option",3),e.setStorageSync("scene",o[0]),this.activate_data=3,this.getseat(o[0])}this.messageApi()},onShow:function(){e.getStorageSync("userinfo")||(this.shopping_trolley_list={}),this.store_defaultApi();var t=e.getStorageSync("userinfo"),n=(e.getStorageSync("addAdish"),e.getStorageSync("option")),o=e.getStorageSync("scene");e.getStorageSync("firstPay");this.option=n,t&&this.getUser(),3==n?(this.seatShow=!1,this.getseat(o)):(o&&(e.removeStorageSync("scene"),e.removeStorageSync("peopleCount")),this.seatShow=!0,this.addAdish=!1),this.enter=!1,this.activate_data=n,this.getlocation(),this.store_defaultApi(1)},onReady:function(){},computed:{wxinfo:function(){var t=e.getMenuButtonBoundingClientRect();return t}},methods:{noticeclick:function(e){console.log(e),this.routergo("/pages/me_all/particulars/particulars?id="+this.contentarr[e].id)},messageApi:function(){var t=this;return(0,a.default)(r.default.mark((function n(){var o;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:o=[],(0,s.message)({page:1,limit:3}).then((function(n){e.hideToast(),1==n.code?(n.data.data.forEach((function(e){o.push(e.content)})),t.contentarr=n.data.data,t.content=o,e.hideToast()):(t.messages=[],e.hideToast()),e.hideToast()})),e.hideToast();case 3:case"end":return n.stop()}}),n)})))()},leftScroll:function(e){for(var t=e.target.scrollTop+400,n=0;n<=this.topList.length;n++)parseInt(t)>=parseInt(this.topList[n])&&parseInt(t)<=parseInt(this.topList[n+1])?(this.components_indexb=n,this.rightId="class"+n):t>=this.topList[this.topList.length-1]&&(this.components_indexb=this.topList.length-1,this.rightId="class"+this.topList.length-1,console.log("选中的最后一个"))},getRightTop:function(){var t=this;this.$nextTick((function(){var n=e.createSelectorQuery().in(t);n.selectAll(".felx_right_box_conten").boundingClientRect((function(e){console.log(e,"进入了"),e.forEach((function(e){t.topList.push(e.top)}))})).exec()}))},countKM:function(e){var t=(1*e/1e3).toFixed(2),n=0;return t>0&&(n=t),n},goorderAll:function(){var t=e.getStorageSync("option");3!==t&&this.routergo("/pages/order_all/selectstore/selectstore")},getUser:function(){return(0,a.default)(r.default.mark((function t(){var n;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,f.userInfo)();case 2:n=t.sent,e.hideToast(),1==n.code&&e.setStorageSync("user",n.data);case 5:case"end":return t.stop()}}),t)})))()},Popconfirm:function(){e.getStorageSync("userinfo")?(this.popshow=!1,this.addshow?e.setStorageSync("peopleCount",this.peopleCount):e.setStorageSync("peopleCount",this.people),this.dine_msg.count=e.getStorageSync("peopleCount")||0,this.order_carListApi()):this.enter=!0},setadd:function(){this.addshow=!1,this.peopleCur=null},setindex:function(e){this.peopleCur=e,this.peopleCount=e+1,this.addshow=!0,this.people=""},getseat:function(t){var n=this;return(0,a.default)(r.default.mark((function o(){var i,a,s;return r.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return i=e.getStorageSync("peopleCount"),e.getStorageSync("userinfo").token,a=e.getStorageSync("firstPay"),o.next=5,(0,d.seat)({id:t});case 5:s=o.sent,1==s.code?(n.scene=s.data,n.seatShow=!1,e.setStorageSync("peopleCount",s.data.people_count),i=e.getStorageSync("peopleCount"),n.dine_msg.count=i,n.dine_msg.number=s.data.no,e.setStorageSync("shop",s.data.store_id),n.store_defaultApi(),s.data.order_id>0?(n.addAdish=1!=a,e.setStorageSync("orderId",s.data.order_id),n.popshow=!1):n.addAdish=!1,e.setStorageSync("addAdish",n.addAdish),setTimeout((function(){n.order_carListApi()}),500),console.log(i,s),i||0!=s.data.order_id||(n.popshow=!0)):e.showToast({title:s.msg,icon:"none"});case 7:case"end":return o.stop()}}),o)})))()},activate:function(t){var n=this;return(0,a.default)(r.default.mark((function o(){return r.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(n.components_index!=t){o.next=2;break}return o.abrupt("return");case 2:return n.components_index=1==t?1:2,e.setStorageSync("option",t),n.activate_data=t,n.store_defaultApi(),o.next=8,(0,d.order_empty)();case 8:o.sent,n.store_infoApi(),n.order_carListApi();case 11:case"end":return o.stop()}}),o)})))()},specification:function(e){var t=this;return(0,a.default)(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.order_id=e.e,t.order_type=e.type,setTimeout((function(){t.$refs.specification.specification(),t.show_specification=!0}),500);case 3:case"end":return n.stop()}}),n)})))()},aid_mgs:function(e,t){this.childindex=t,this.leftId=e},swpclick:function(t){if(console.log(t),e.getStorageSync("userinfo")){if(t){var n=["/pages/index/index","/pages/order/order","/pages/order_form/order_form","/pages/me/me"];n.includes(t)?e.switchTab({url:t}):e.navigateTo({url:t})}}else this.enter=!0},getlocation:function(){return(0,a.default)(r.default.mark((function t(){return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getLocation({success:function(t){e.setStorageSync("location",t)}});case 1:case"end":return t.stop()}}),t)})))()},store_defaultApi:function(t){var n=this;return(0,a.default)(r.default.mark((function o(){var i,a;return r.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return i=e.getStorageSync("shop"),o.next=3,(0,d.store_default)({id:i||""});case 3:a=o.sent,1==a.code&&(n.store_default_data=a.data,e.setStorageSync("shop",n.store_default_data.id),e.setStorageSync("currentShop",n.store_default_data)),1==a.data.takeaway_switch&&1!==a.data.delivery_switch&&(n.activate_data=2,e.setStorageSync("option",2)),n.list1=a.data.image,n.list1url=a.data.tz_url,1==t&&n.store_infoApi(),n.order_carListApi();case 10:case"end":return o.stop()}}),o)})))()},store_collectionApi:function(t){var n=this;return(0,a.default)(r.default.mark((function o(){return r.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(e.getStorageSync("userinfo")){o.next=6;break}return n.enter=!0,e.showToast({title:"未登录",icon:"none"}),o.abrupt("return");case 6:if(!t){o.next=13;break}return o.next=9,(0,d.store_cancelColl)({store_id:n.store_default_data.id});case 9:o.sent,o.next=17;break;case 13:return o.next=15,(0,d.store_collection)({store_id:n.store_default_data.id});case 15:o.sent;case 17:n.store_defaultApi();case 18:case"end":return o.stop()}}),o)})))()},store_infoApi:function(){var e=this;return(0,a.default)(r.default.mark((function t(){var n,o;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,d.store_info)({store_id:e.store_default_data.id,shipment:e.activate_data||2});case 2:o=t.sent,console.log(o,"商品数据"),e.store_infoApi_data=[],(n=e.store_infoApi_data).push.apply(n,(0,i.default)(o.data)),e.orderlist=o.data[0].goods,e.display=!0,e.getRightTop();case 9:case"end":return t.stop()}}),t)})))()},selective_specification:function(e,t,n,o){var i=this;return(0,a.default)(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:i,i.specification_list.forEach((function(n,r){n.item.forEach((function(n,i){n.id==t?n.is_show?2==o&&(n.is_show=!1):n.is_show=!0:1==o&&r==e&&(n.is_show=!1)}))})),i.style=[],i.specification_list.forEach((function(e){e.item.forEach((function(e,t){e.is_show&&i.style.push(e)}))})),i.store_itemPriceApi(),i.$forceUpdate();case 6:case"end":return n.stop()}}),n)})))()},store_itemPriceApi:function(){var e=this;return(0,a.default)(r.default.mark((function t(){var n,o;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="",e.style.forEach((function(e){n+=e.id+"_"})),n=n.substring(0,n.length-1),t.next=5,(0,d.store_itemPrice)({goods_id:e.order_id,spu_id:n});case 5:o=t.sent,e.orderprive=u.default.BumberPrecision(o.data.price);case 7:case"end":return t.stop()}}),t)})))()},add_joinCar:function(){var t=this;return(0,a.default)(r.default.mark((function n(){var o,i;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.getStorageSync("userinfo")){n.next=3;break}return t.enter=!0,n.abrupt("return");case 3:return o=[],t.style.forEach((function(e){o.push(e.id)})),n.next=7,(0,d.order_joinCar)({store_id:t.store_default_data.id,goods_id:t.order_id,spu_id:o,count:1,order_type:t.activate_data});case 7:i=n.sent,1==i.code?(e.showToast({title:i.msg,icon:"none"}),t.order_carListApi(),t.show_specification=!1,t.style=[]):e.showToast({title:i.msg,icon:"none"});case 9:case"end":return n.stop()}}),n)})))()},order_carListApi:function(){var t=this;return(0,a.default)(r.default.mark((function n(){var o,i,a,s,c,u,l;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(o=e.getStorageSync("userinfo").token,o){n.next=4;break}return t.shopping_trolley_list=[],n.abrupt("return");case 4:if(a=e.getStorageSync("peopleCount")||0,s=e.getStorageSync("scene"),c=t.store_default_data.iscwf,u=e.getStorageSync("firstPay"),l=t.addAdish?2:1,1!=c){n.next=21;break}if(2!=u){n.next=16;break}return n.next=13,(0,d.order_carList)({peopleCount:a,type:l,store_id:t.store_default_data.id,seat_id:s});case 13:i=n.sent,n.next=19;break;case 16:return n.next=18,(0,d.order_carList)({store_id:t.store_default_data.id,peopleCount:a,seat_id:s});case 18:i=n.sent;case 19:n.next=25;break;case 21:return console.log("店铺id",s,"不需要餐位费"),n.next=24,(0,d.order_carList)({store_id:t.store_default_data.id,seat_id:s});case 24:i=n.sent;case 25:1==i.code?t.shopping_trolley_list=i.data:t.shopping_trolley_list=[];case 26:case"end":return n.stop()}}),n)})))()},register:function(){this.enter=!0},router_close:function(t){e.reLaunch({url:t})},routergo:function(t){e.navigateTo({url:t})},closepage:function(){this.enter=!1},refresherpulling:function(){}}};t.default=h}).call(this,n(2)["default"])},193:function(e,t,n){"use strict";n.r(t);var o=n(194),r=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=r.a},194:function(e,t,n){},195:function(e,t,n){"use strict";n.r(t);var o=n(196),r=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=r.a},196:function(e,t,n){}},[[185,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/order/order.js.map